# GradeLoop Core V2 - Web Client Context

This project is a high-performance web client built with **Bun**, **Next.js (App Router)**, and a strictly typed ecosystem for an AI-integrated Learning Management System (LMS).

## Primary Tech Stack
- **Runtime**: Bun (Strictly use `bun` for scripts and package management)
- **Framework**: Next.js 16+ (App Router)
- **UI Architecture**: HeroUI v3 (React Native/Web unified components)
- **Animation**: Motion (The `motion` package; avoid `framer-motion` imports)
- **State Management**: Zustand v5 (Store-based, immutable state)
- **Data Layer**: TanStack Query v5 (React Query)
- **HTTP Client**: Axios (Instance-based)
- **Form Handling**: React Hook Form v7 with Hookform Resolvers
- **Validation**: Zod v4 (Schema-first development)
- **Styling**: TailwindCSS v4 with PostCSS
- **Utilities**: clsx for conditional classes, date-fns for date manipulation

## Development Standards & Patterns

### 1. Data Fetching & Type Safety (The "Golden Pipeline")
All API interactions must follow this rigid flow to ensure runtime and compile-time safety:
- **Define Schemas**: Create a Zod schema in `@/schemas` or feature folders.
- **Axios Fetchers**: Perform requests using a central Axios instance.
- **Validation**: Every fetcher MUST use `Schema.parse(response.data)` before returning. Do not use `as Type` assertions.
- **Query Hooks**: Wrap fetchers in TanStack Query `useQuery` or `useMutation` hooks.
- **Example Pattern**:
  ```typescript
  // Schema Definition
  const UserSchema = z.object({
    id: z.string(),
    name: z.string(),
    email: z.string().email(),
    role: z.enum(['student', 'instructor', 'admin'])
  });

  // Fetcher with validation
  const getUser = async (id: string) => {
    const res = await api.get(`/user/${id}`);
    return UserSchema.parse(res.data);
  };

  // Query Hook
  const useUser = (id: string) =>
    useQuery({
      queryKey: ['user', id],
      queryFn: () => getUser(id)
    });
  ```

### 2. UI & Styling (HeroUI v3 + Motion + TailwindCSS)
- **Component Source**: Use `@heroui/react` (v3) and `@heroui/styles`.
- **Layouts**: Use HeroUI's layout components (Navbar, Card, Modal) as primary containers.
- **Animations**: Use the `motion` package for all transitions.
  - Correct import: `import { motion } from "motion/react"` or `import { motion } from "motion"`.
  - Avoid `framer-motion` legacy references.
- **Styling**: TailwindCSS v4 with utility-first approach.
- **Server vs Client**: Explicitly mark HeroUI/Motion components with `'use client'` at the top of the file.

### 3. Form Handling (React Hook Form + Zod)
- Use React Hook Form v7 with Zod validation via `@hookform/resolvers`.
- Pattern:
  ```typescript
  const formSchema = z.object({
    email: z.string().email(),
    password: z.string().min(8)
  });

  const { register, handleSubmit, formState: { errors } } = useForm({
    resolver: zodResolver(formSchema)
  });
  ```

### 4. State Management (Zustand v5)
- Use the `create<T>()` pattern with explicit interfaces.
- **Shallow Checks**: Use `useStore` with selectors to prevent unnecessary re-renders.
- **Persistence**: Only use persist middleware for essential session data (e.g., Auth, Theme).
- **Separation of Concerns**: Do not store TanStack Query cache data in Zustand. Keep server-state and UI-state separate.

### 5. Code Style & Architecture
- **Naming**: Use PascalCase for components, camelCase for hooks and functions.
- **Structure**: Feature-based directory structure (e.g., `/features/auth`, `/features/dashboard`).
- **Icons**: Use `lucide-react` or HeroUI's built-in icon sets.
- **TypeScript**: Strict mode enabled, no `any` types allowed.

## Project Structure Reference
```
/apps/web/
├── app/                    # Next.js App Router (Pages and Layouts)
│   ├── globals.css         # Global TailwindCSS styles
│   ├── layout.tsx          # Root layout with providers
│   └── page.tsx            # Home page
├── components/             # Shared UI atoms/molecules
├── features/               # Domain-specific logic (hooks, components, schemas)
├── lib/                    # Shared instances (axios, queryClient)
├── store/                  # Zustand store definitions
├── schemas/                # Zod validation schemas
├── public/                 # Static assets
├── package.json            # Dependencies and scripts
├── tsconfig.json           # TypeScript configuration
├── next.config.ts          # Next.js configuration
├── tailwind.config.ts      # TailwindCSS configuration
└── postcss.config.mjs      # PostCSS configuration
```

## Critical Instructions for AI Agents

### Package Management
- **No NPM/Yarn**: Use `bun add` and `bun run` exclusively.
- **Installation**: Always use `bun install` for dependency installation.
- **Scripts**: Run development with `bun run dev`, build with `bun run build`.

### Framework Specifics
- **HeroUI v3**: Refer to v3 documentation specifically; do not use v2 (NextUI) syntax.
- **Next.js**: Use App Router patterns, not Pages Router.
- **React**: Version 19+ with concurrent features.

### Error Handling
- Always wrap Zod parsing in try/catch within fetchers or allow TanStack Query to handle the error state for the UI.
- Use proper error boundaries for React error handling.

### Hydration & SSR
- Ensure `QueryClientProvider` and `HeroUIProvider` are implemented in the root layout with a Client Component wrapper.
- Handle hydration mismatches properly with Next.js patterns.

### Development Workflow
1. **Dependencies**: All major dependencies are already configured in package.json.
2. **Linting**: ESLint with Next.js configuration is set up.
3. **TypeScript**: Strict mode with proper path mapping (`@/*` for root imports).
4. **Git**: Follow conventional commits as specified in CONTRIBUTING.md.

## Business Context
GradeLoop is an AI-integrated Learning Management System designed for educational institutions. The web client serves multiple user roles:
- **Students**: Assignment submissions, grade viewing, course enrollment
- **Instructors**: Course management, grading, assignment creation
- **Administrators**: System management, analytics, user administration

## Key Features to Implement
- Dashboard with role-based views
- Assignment management system
- AI-powered plagiarism detection interface
- Real-time notifications
- Grade analytics and reporting
- Course enrollment workflows
- User authentication and authorization

## Performance Requirements
- Fast initial page load (<2s)
- Smooth animations (60fps)
- Efficient data fetching with proper caching
- Mobile-responsive design
- Accessibility compliance (WCAG 2.1 AA)

This context should guide all development decisions and code generation for the GradeLoop V2 web client.
