routes:
  # ==========================================
  # Academics Service Routes
  # ==========================================
  # Faculty Routes
  - path: "/api/academics/faculties"
    method: "POST"
    permission: "academics:faculties:write"
    service: "academics"
  - path: "/api/academics/faculties"
    method: "GET"
    permission: "academics:faculties:read"
    service: "academics"
  - path: "/api/academics/faculties/:id"
    method: "GET"
    permission: "academics:faculties:read"
    service: "academics"
  - path: "/api/academics/faculties/:id"
    method: "PATCH"
    permission: "academics:faculties:write"
    service: "academics"
  - path: "/api/academics/faculties/:id"
    method: "DELETE"
    permission: "academics:faculties:write"
    service: "academics"
  - path: "/api/academics/faculties/:id/leaders"
    method: "GET"
    permission: "academics:faculties:read"
    service: "academics"

  # Department Routes
  - path: "/api/academics/faculties/:faculty_id/departments"
    method: "POST"
    permission: "academics:departments:write"
    service: "academics"
  - path: "/api/academics/faculties/:faculty_id/departments"
    method: "GET"
    permission: "academics:departments:read"
    service: "academics"
  - path: "/api/academics/departments/:id"
    method: "GET"
    permission: "academics:departments:read"
    service: "academics"
  - path: "/api/academics/departments/:id"
    method: "PATCH"
    permission: "academics:departments:write"
    service: "academics"
  - path: "/api/academics/departments/:id"
    method: "DELETE"
    permission: "academics:departments:write"
    service: "academics"

  # Degree Routes
  - path: "/api/academics/departments/:department_id/degrees"
    method: "POST"
    permission: "academics:degrees:write"
    service: "academics"
  - path: "/api/academics/departments/:department_id/degrees"
    method: "GET"
    permission: "academics:degrees:read"
    service: "academics"
  - path: "/api/academics/degrees/:id"
    method: "GET"
    permission: "academics:degrees:read"
    service: "academics"
  - path: "/api/academics/degrees/:id"
    method: "PATCH"
    permission: "academics:degrees:write"
    service: "academics"
  - path: "/api/academics/degrees/:id"
    method: "DELETE"
    permission: "academics:degrees:write"
    service: "academics"

  # Specialization Routes
  - path: "/api/academics/degrees/:degree_id/specializations"
    method: "POST"
    permission: "academics:specializations:write"
    service: "academics"
  - path: "/api/academics/degrees/:degree_id/specializations"
    method: "GET"
    permission: "academics:specializations:read"
    service: "academics"
  - path: "/api/academics/specializations/:id"
    method: "GET"
    permission: "academics:specializations:read"
    service: "academics"
  - path: "/api/academics/specializations/:id"
    method: "PATCH"
    permission: "academics:specializations:write"
    service: "academics"
  - path: "/api/academics/specializations/:id"
    method: "DELETE"
    permission: "academics:specializations:write"
    service: "academics"

  # Batch Routes
  - path: "/api/academics/batches"
    method: "POST"
    permission: "academics:batches:write"
    service: "academics"
  - path: "/api/academics/batches/:id"
    method: "GET"
    permission: "academics:batches:read"
    service: "academics"
  - path: "/api/academics/batches/:id/children"
    method: "GET"
    permission: "academics:batches:read"
    service: "academics"
  - path: "/api/academics/batches/tree/:root_id"
    method: "GET"
    permission: "academics:batches:read"
    service: "academics"
  - path: "/api/academics/batches/:id"
    method: "PATCH"
    permission: "academics:batches:write"
    service: "academics"
  - path: "/api/academics/batches/:id"
    method: "DELETE"
    permission: "academics:batches:write"
    service: "academics"
  
  # Batch Membership
  - path: "/api/academics/batches/:batch_id/members"
    method: "POST"
    permission: "academics:batches:write"
    service: "academics"
  - path: "/api/academics/batches/:batch_id/members"
    method: "GET"
    permission: "academics:batches:read"
    service: "academics"
  - path: "/api/academics/batches/:batch_id/members/:user_id"
    method: "PATCH"
    permission: "academics:batches:write"
    service: "academics"

  # Course Instance
  - path: "/api/academics/course-instances"
    method: "POST"
    permission: "academics:courses:write"
    service: "academics"
  - path: "/api/academics/course-instances/:id"
    method: "GET"
    permission: "academics:courses:read"
    service: "academics"
  - path: "/api/academics/course-instances/:id"
    method: "PATCH"
    permission: "academics:courses:write"
    service: "academics"

  # Course Instructor
  - path: "/api/academics/course-instances/:id/instructors"
    method: "POST"
    permission: "academics:courses:write"
    service: "academics"
  - path: "/api/academics/course-instances/:id/instructors"
    method: "GET"
    permission: "academics:courses:read"
    service: "academics"
  - path: "/api/academics/course-instances/:id/instructors/:user_id"
    method: "DELETE"
    permission: "academics:courses:write"
    service: "academics"
  
  # Course Enrollment
  - path: "/api/academics/course-instances/:id/enrollments"
    method: "POST"
    permission: "academics:courses:write"
    service: "academics"
  - path: "/api/academics/course-instances/:id/enrollments"
    method: "GET"
    permission: "academics:courses:read"
    service: "academics"
  - path: "/api/academics/course-instances/:id/enrollments/:user_id"
    method: "PATCH"
    permission: "academics:courses:write"
    service: "academics"

  # Course Routes
  - path: "/api/academics/courses"
    method: "POST"
    permission: "academics:courses:write"
    service: "academics"
  - path: "/api/academics/courses"
    method: "GET"
    permission: "academics:courses:read"
    service: "academics"

  # Semester Routes
  - path: "/api/academics/semesters"
    method: "POST"
    permission: "academics:semesters:write"
    service: "academics"
  - path: "/api/academics/semesters"
    method: "GET"
    permission: "academics:semesters:read"
    service: "academics"

  # ==========================================
  # IAM Service Routes
  # ==========================================
  # Public / Auth Routes (handled by gateway for routing, potentially public)
  # NOTE: Public routes might need a special "public" permission or middleware bypass.
  # For now, we will assign a "public" permission and handle it in middleware or assume tokens have it?
  # Better approach: If permission is empty or "public", skip check?
  # Or mapping public routes to a "public" permission that everyone claims?
  # Let's assume for now we expose non-public routes here or use a specific bypass.
  # Using "auth:public" for public routes which we might check or skip.

  - path: "/api/iam/health"
    method: "GET"
    permission: "public"
    service: "iam"

  # Auth - These are public endpoints, but proxied
  - path: "/api/v1/auth/login"
    method: "POST"
    permission: "public"
    service: "iam"
  - path: "/api/v1/auth/refresh"
    method: "POST"
    permission: "public"
    service: "iam"
  - path: "/api/v1/auth/activate"
    method: "POST"
    permission: "public"
    service: "iam"
  - path: "/api/v1/auth/request-activation"
    method: "POST"
    permission: "public"
    service: "iam"
  
  # Token Management
  - path: "/api/v1/auth/refresh-tokens/:token_id"
    method: "DELETE"
    permission: "iam:auth:revoke" # User can revoke own tokens
    service: "iam"

  # User Management
  - path: "/api/v1/users"
    method: "POST"
    permission: "public"
    service: "iam"
  - path: "/api/v1/users"
    method: "GET"
    permission: "iam:users:read"
    service: "iam"
  - path: "/api/v1/users/:id"
    method: "GET"
    permission: "iam:users:read"
    service: "iam"
  - path: "/api/v1/users/:id"
    method: "PUT"
    permission: "iam:users:write"
    service: "iam"
  - path: "/api/v1/users/:id"
    method: "DELETE"
    permission: "iam:users:write"
    service: "iam"
  - path: "/api/v1/users/:id/restore"
    method: "PATCH"
    permission: "iam:users:write"
    service: "iam"
  - path: "/api/v1/users/:id/revoke-all-tokens"
    method: "POST"
    permission: "iam:users:write"
    service: "iam"
  
  # Role Management
  - path: "/api/v1/roles"
    method: "POST"
    permission: "iam:roles:write"
    service: "iam"
  - path: "/api/v1/roles"
    method: "GET"
    permission: "iam:roles:read"
    service: "iam"
  - path: "/api/v1/roles/:id/permissions"
    method: "PATCH"
    permission: "iam:roles:write"
    service: "iam"
  - path: "/api/v1/roles/:id"
    method: "DELETE"
    permission: "iam:roles:write"
    service: "iam"
  
  # Permission Catalog
  - path: "/api/v1/permissions"
    method: "GET"
    permission: "iam:permissions:read"
    service: "iam"
  - path: "/api/v1/permissions/:name"
    method: "GET"
    permission: "iam:permissions:read"
    service: "iam"

  # Explicitly blocked routes (registered in IAM service router but blocked with 405)
  # We register them here to satisfy validation, mapping to a "blocked" permission
  - path: "/api/v1/permissions"
    method: "POST"
    permission: "blocked"
    service: "iam"
  - path: "/api/v1/permissions/:name"
    method: "PUT"
    permission: "blocked"
    service: "iam"
  - path: "/api/v1/permissions/:name"
    method: "PATCH"
    permission: "blocked"
    service: "iam"
  - path: "/api/v1/permissions/:name"
    method: "DELETE"
    permission: "blocked"
    service: "iam"

  # ==========================================
  # Email Notify Service Routes
  # ==========================================
  - path: "/api/v1/email/send"
    method: "POST"
    permission: "email:send:write"
    service: "email-notify"
  - path: "/api/v1/email/test-template"
    method: "POST"
    permission: "email:send:write"
    service: "email-notify"

upstream:
  academics: "http://academics-service:3000"
  iam: "http://iam-service:3000"
  email-notify: "http://email-notify-service:8080"

